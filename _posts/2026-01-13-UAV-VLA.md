---
layout: post
title: "[Paper review] UAV-VLA: Vision-Language-Action System for Large Scale Aerial Mission Generation"
tags: [Paper]
math: true
---

# UAV-VLA Paper Review

---
UAV-VLA는 UAV(무인항공기)를 위한 VLA 시스템을 사용하여 대규모 항공 임무를 생성하는 방법을 제안하는 논문입니다. 위성 이미지를 바탕으로 사용자의 자연어 명령을 이해하고, 이를 바탕으로 드론이 수행할 수 있는 효율적인 비행 경로와 임무 계획을 자동으로 생성합니다. 드론과 VLA에 관심이 있어 리뷰를 해보려고 합니다.

---
## Introduction
최근 몇 년간, 무인 항공기(UAV)는 개발과 감시, 농업, 재난 관리 등 다양한 분야에서 활용되고 있습니다. 임무의 복잡성이 증가함에 따라 운용자(사람)와 UAV간의 효과적인 통신에 대한 필요성이 매우 중요해졌습니다. 전통적인 상호작용 방식은 종종 복잡한 프로그래밍이나 수동 제어에 의존하는데, 이는 번거롭고 이러한 기술의 접근성은 사용자층에게 제한적일 수 있습니다.

이를 해결하기 위해 추가적인 훈련 없이 강력한 모델의 Zero-shot 기능을 활용해, 오직 언어 지시와 개방형 위성 데이터만을 기반으로 경로 계획을 생성하고 행동하는 시스템 개발에 중점을 둡니다.

해당 논문의 기여는 세 가지입니다.
1. 위성 이미지를 사용하여 텍스트 기반 임무 요청으로부터 경로-행동 세트를 생성하는 VLA 시스템을 제시합니다.
2. VLA 시스템을 전역적 규모로 평가하기 위한 UAV-VLPA-nano-30 벤치마크를 소개합니다.
3. UAV-VLPA-nano-30에서 시스템을 검증하며, 인간 수준의 경로 및 행동 생성과 유사한 성능을 보여줍니다.

---
## Data & Benchmark
UAV-VLA를 평가하기 위해 새로운 벤치마크 데이터셋인 UAV-VLPA-nano-30을 소개합니다. 이 벤치마크는 30개의 고해상도 위성 이미지로 구성됩니다. UAV에서의 임무 생성을 위해 설계된 이 벤치마크는 UAV-VLA 시스템이 언어적 지시를 해석하고 실행 가능한 내비게이션 계획을 생성하는 능력을 평가하기 위한 표준화된 테스트베드를 제공합니다.

해당 벤치마크는 미국 전역의 다양한 지역을 포함하며, 도시, 교외, 농촌 및 자연환경을 아우릅니다. 이들에는 건물(주택, 창고), 스포츠 경기장, 연못, 호수, 교통 기반 시설 등이 포함됩니다.

숙련된 드론 운영자가 벤치마크 이미지에 대해 *"Create a flight plan for a quadcopter to fly over all buildings inside the violet square. Height is not considered"*와 같은 지시를 받아 비행 계획을 생성합니다.

![image](/assets/images/uav-vla/uav-vla_image1.png)

드론 운영자는 35분동안 30개의 이미지에 대한 비행 계획을 수동으로 생성했습니다. 운영자가 Mission Planner를 사용하여 생성한 UAV-VLPA-nano-30 벤치마크 샘플의 총 길이는 63.89km였고, 평균 길이는 2.13km입니다.

---
## Methodology
![image](/assets/images/uav-vla/uav-vla_image2.png)

본 논문에서는 공중 임무에서의 행동 예측을 위해 LLM과 VLM을 활용하는 새로운 UAV-VLA 시스템을 제시합니다. 해당 프레임워크는 목표 추출 GPT 모듈, 객체 탐색 VLM 모듈, 행동 생성 GPT 모듈의 세 가지 주요 모듈로 구성됩니다.

프로세스는 언어 명령으로 시작합니다.

$$I = \{i_1, i_2, \dots, i_k\}$$

여기서 $I$는 작업 복잡성에 따라 달라지는 길이 $k$의 입력 프롬프트입니다.

목표 추출 GPT 모듈은 $I$를 목표의 집합으로 파싱합니다.

$$G = \text{GPT}(I) = \{g_1, g_2, \dots, g_n\} \quad$$

여기서 $G$는 명령에서 파생된, 작업에 맞게 조정된 목표들을 포함합니다.

객체 탐색 VLM 모듈은 위성 이미지에서 이러한 목표들을 식별하여 처리된 점들을 생성합니다.

$$P_p = \text{Molmo}(G) = \{[g_{1,1}, g_{1,2}], [g_{2,1}, g_{2,2}], \dots, [g_{n,1}, g_{n,2}]\} \quad$$

이 점들은 메타데이터를 사용하여 전역 좌표로 변환됩니다.

$$P_g = f(P_p) = \{[lat_{1,1}, lon_{1,2}], \dots, [lat_{n,1}, lon_{n,2}]\} \quad$$

마지막으로 행동 생성 GPT 모듈은 $P_g$, 미션 세부 정보 및 MAVProxy를 사용하여 UAV 행동을 생성합니다.

$$A = \text{GPT}(P_g, [\mathcal{A}_b]) = \{A_1, A_2, \dots, A_n\} \quad$$

이 파이프라인은 명령 파싱, 객체 탐지 및 좌표 변환을 통합하여 UAV가 특정 작업에 맞게 조정된 정확한 미션 계획을 자율적으로 생성할 수 있도록 합니다.

---
## Experiments
본 세션에서는 소개된 벤치마크를 사용하여 UAV-VLA 시스템을 평가하며, 비행 계획 생성과 시스템 효과성을 평가하기 위한 새로운 평가 지표에 초점을 맞춥니다.

#### Evaluation Metrics
평가 지표는 경로의 총 길이와 시스템 생성 궤적과 운영자가 생성(실측) 궤적 간의 오차라는 두 가지 측면을 고려합니다.

오차 계산을 위해 세 가지 방법이 사용되었습니다. Sequential Method는 단계별로 정렬하지만 누적 오차에 취약합니다. Dynamic Time Warping(DTW)는 경로 유사성을 측정하기 위해 비선형 정렬을 허용합니다. K-Nearest Neighbors(KNN)는 순서를 고려하지 않고 일반적인 정확도 측정치를 제공하며, 시스템 포인트를 가장 가까운 실측 포인트에 매칭합니다.

오차는 Root Mean Square Error(RMSE)를 사용하여 정량화됩니다.

$$RMSE = \sqrt{\frac{1}{n}\sum_{i=1}^{n}((x_n - \hat{x}_n)^2 + (y_n - \hat{y}_n)^2)}$$

여기서 $x_n$과 $\hat{x}_n$은 각각 시스템 생성 포인트와 실측 포인트이며, n은 총 포인트 수입니다.

#### System Setup & Procedure
시스템은 *"Create a flight plan for the quadcopter to fly around each building at a height 100m, return to home, and land at the take-off point"* 명령어를 사용하여 평가되었습니다.

실험은 RTX4090 그래픽 카드와 Intel Core i9-13900K CPU를 탑재한 PC에서 수행되었습니다. 메모리 제약으로 인해 quantized Molmo-7B-D BnB 4-bit model이 사용되었습니다.

![image](/assets/images/uav-vla/uav-vla_image3.png)

---
## Experimental Results
UAV-VLA는 벤치마크에서 77.74km의 일반적인 궤적 길이를 보여주었습니다. 이는 숙련된 UAV 조종사가 생성한 실제 궤적보다 13.85km, 즉 21.6% 더 긴 것입니다.

30개 사례 중 7개, 즉 23%의 경우 UAV-VLA는 더 짧은 궤적 경로를 생성했습니다.

![image](/assets/images/uav-vla/uav-vla_image4.png)

순차적 RMSE는 경로당 409.54m의 가장 큰 평균 오차를 보였는데, 이는 점들의 순차적 순서에 대한 엄격한 의존성 때문으로 예상되었습니다. DTW 방식은 307.27m의 평균 오차를 기록하며, 시간적 변화를 더 효과적으로 고려하는 능력을 강조합니다. KNN은 순서를 완전히 무시하고 점들의 공간적 근접성에만 집중하기 때문에 가장 작은 평균 오차를 보였습니다.

![image](/assets/images/uav-vla/uav-vla_image5.png)

UAV-VLA 시스템은 모든 벤치마크 이미지를 약 5분 24초 안에 처리합니다. 이 중 2분은 객체 검색 VLM 모듈을 사용하여 필수 지점을 식별하고, 3분 24초는 액션 생성 GPT 모듈을 사용하여 임무 파일을 생성하는 데 소요됩니다. 이는 숙련된 조종자가 생성한 flight plans보다 6.5배 더 빠릅니다.

---
## Conclusion
본 논문은 임무 계획의 유연성과 정확성을 향상시키는 전역 규모 UAV 임무 생성 접근법을 제시합니다. 전통적인 수동 방식의 한계를 극복함으로써, 이 접근법은 인간의 개입이 비효율적인 시나리오에서 매우 유익합니다.

이 방법은 직접적인 자연어 통신을 가능하게 하여 인간-UAV 상호작용을 단순화하고, 동적인 환경에서 원활한 로봇 간 협업의 기반을 마련합니다.

---
## Future Work
향후 연구는 UAV 임무 생성에서 모델의 정확도와 효율성을 향상시키기 위해 위성 지도 기반 경로 계획을 위한 특화된 데이터셋을 생성하는 데 초점을 맞출것입니다. 또한, 다양한 환경에 걸쳐 완전 자율 UAV 임무 계획을 이해 행동 생성, 경로 계획, 의사 결정을 통합하여 높은 수준의 목표로부터 임무 계획을 자율적으로 생성하는 end-to-end 모델을 개발하고자 합니다.